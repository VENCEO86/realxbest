# 📊 데이터 수집 분석 및 개선 방안

## ✅ 현재 상태 확인

### API 키 인식 상태
- ✅ **YOUTUBE_API_KEYS**: 정상 인식 (3개 키)
- ✅ **DATABASE_URL**: 정상 인식
- ✅ **모든 Secrets**: 올바른 형식

### 현재 데이터 현황
- 총 채널 수: **4,722개**
- 주요 국가별 현황:
  - IT (이탈리아): 2,183개
  - US (미국): 1,294개
  - MX (멕시코): 559개
  - CA (캐나다): 525개
  - KR (한국): 25개 ⚠️ 부족
  - ES (스페인): 19개 ⚠️ 부족

---

## 🔍 데이터 증가가 제한되는 원인 분석

### 1. 중복 체크 로직 (의도된 설계)

**현재 동작:**
```typescript
if (existing) {
  // 기존 채널은 업데이트하지 않음 (할당량 절약)
  return false; // 새로 저장한 것이 아님
}
```

**문제점:**
- ✅ **의도된 설계**: API 할당량 절약을 위해 기존 채널은 저장하지 않음
- ⚠️ **부작용**: 같은 채널을 다른 국가에서 발견해도 저장되지 않음
- 예시: 채널 A가 IT로 이미 저장되어 있으면, KR 검색에서 발견해도 저장 안 됨

**이것이 문제인가?**
- ❌ **아니요**: 채널 ID가 같으면 같은 채널이므로 중복 저장은 맞지 않음
- ✅ **정상**: 중복 체크는 올바른 설계입니다

---

### 2. 최소 기준이 높음

**현재 설정:**
- 최소 구독자: **30,000명 이상**
- 최소 조회수: **1,000,000회 이상**
- 많은 국가: **50,000명 이상** (IT, US, MX, CA)

**영향:**
- 이 기준을 만족하는 채널이 상대적으로 적을 수 있음
- 특히 데이터가 적은 국가(KR, ES 등)에서는 더욱 제한적

**예시:**
- 한국에서 3만명 이상 구독자를 가진 채널이 실제로 많지 않을 수 있음
- 검색 결과에서 기준을 만족하는 채널이 적으면 데이터 증가가 느림

---

### 3. API 할당량 제한

**현재 설정:**
- 키당 일일 할당량: **9,000 units**
- 3개 키 = 총 **27,000 units**

**할당량 사용:**
- Search API: 100 units/요청
- Channels API: 1 unit/요청
- 배치 처리: 50개씩 = 1 unit

**영향:**
- 할당량이 소진되면 수집이 중단됨
- 많은 국가/카테고리를 수집하려면 할당량이 부족할 수 있음

---

### 4. 검색 결과의 한계

**현재 검색 방식:**
- 키워드 기반 검색
- 국가별/카테고리별 검색
- 정렬 기준: viewCount, rating, relevance

**한계:**
- YouTube API의 검색 결과는 제한적일 수 있음
- 같은 키워드로 반복 검색하면 중복 결과가 많을 수 있음
- 새로운 채널 발견이 어려울 수 있음

---

## 💡 개선 방안

### 방안 1: 최소 기준 완화 (데이터 부족 국가)

**현재:**
```typescript
KR: { subscribers: 30000, views: 1000000 }
```

**개선:**
```typescript
// 데이터가 매우 적은 국가는 기준 완화
KR: { subscribers: 10000, views: 500000 }  // 1만명 이상
```

**장점:**
- 더 많은 채널 수집 가능
- 데이터 부족 국가의 채널 수 증가

**단점:**
- 품질이 낮은 채널도 포함될 수 있음

---

### 방안 2: 검색 키워드 다양화

**현재:**
- 기본 키워드 + 현지어 키워드

**개선:**
- 더 다양한 검색 패턴 추가
- 트렌딩 채널 검색
- 인기 채널 목록 활용

---

### 방안 3: 수집 전략 조정

**현재:**
- 국가별/카테고리별 순차 수집

**개선:**
- 데이터 부족 국가에 더 많은 할당량 배분
- 우선순위 국가에 집중 수집

---

### 방안 4: 수동 수집 스크립트 활용

**추가 스크립트:**
- `priority-collect-low-data-countries.ts`: 데이터 부족 국가 우선 수집
- 수동 실행으로 즉시 수집 가능

---

## 📋 권장 조치

### 즉시 실행 가능:

1. **최소 기준 완화 (데이터 부족 국가)**
   - KR, ES 등 10개 미만 국가: 1만명 이상으로 완화
   - 더 많은 채널 수집 가능

2. **수동 수집 스크립트 실행**
   - `priority-collect-low-data-countries.ts` 실행
   - 데이터 부족 국가에 집중 수집

3. **GitHub Actions 수동 실행**
   - 더 자주 실행하여 데이터 축적
   - 할당량 범위 내에서 반복 실행

### 장기 개선:

1. **검색 전략 개선**
   - 더 다양한 검색 패턴
   - 트렌딩 채널 활용

2. **할당량 관리 최적화**
   - 효율적인 API 사용
   - 배치 처리 최적화

---

## ✅ 결론

**현재 상태:**
- ✅ API 키 정상 인식
- ✅ 중복 체크 정상 작동 (의도된 설계)
- ⚠️ 데이터 증가가 느린 이유: 최소 기준이 높고, 검색 결과의 한계

**문제가 아닌 것:**
- ❌ 중복 체크 로직 (의도된 설계, 정상 작동)
- ❌ 설계 오류 (없음)

**실제 원인:**
- ⚠️ 최소 기준이 높아서 만족하는 채널이 적음
- ⚠️ 검색 결과의 한계
- ⚠️ API 할당량 제한

**개선 방안:**
- 💡 데이터 부족 국가의 최소 기준 완화
- 💡 수동 수집 스크립트 활용
- 💡 더 자주 실행하여 데이터 축적

